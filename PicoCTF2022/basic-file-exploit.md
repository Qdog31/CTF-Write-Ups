# basic-file-exploit.md 
- Category : Binary Exploitation	
- Points : 100
- Flag: picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_149F090A}


## Challenge

The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it! Connect to the program with netcat: $ nc saturn.picoctf.net 55826 The program's source code with the flag redacted can be downloaded here.

Hint: Try passing in things the program doesn't expect. Like a string instead of a number.

## Solve

1) Like all other challenges that provide a netcat connection, I ran it to see what it had. 
2) After running it, I noticed that it gave me three different options. 1) was to enter a phrase into the database, 2) was to echo a phrase in our database and 3) was to exit the program 
3) After messing around by inputting different things into each option, I took a look at the provided source code 
4) After looking through the source code, the below part stood out to me. 

```
if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
```

`puts(flag)` stood out to me because I knew the puts command would write a string to stdout and display it to me, the user. 

5) At this point, I knew that I would have to exploit this chunk of code in order to get the flag to be printed. I just did not know how. 
6) I then looked looked at the hint, which suggested that I input a string over a number that it was exepting.
7) To get the flag, I went through the different options until the `Please enter the entry number of your data:` message popped up, and I proceeded to overflow the buffer with a random amount of letter A's. 

## Thoughts

Although this was an easy challenge, it shows how a buffer overflow works in a cool way. In this challenge, we saw an interactive interface that collected a users input and provided (in this case echoed) information back. This is good for us, because we can exploit these programs to inputting thimgs it might not want. It took me a while to get it at first, but after realizing where in the program I had to get and what I had to do, it was not too bad. 
